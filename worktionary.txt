Started: 20 February 2016

The OpenShift `ruby` cartridge documentation can be found at:
http://openshift.github.io/documentation/oo_cartridge_guide.html#ruby


login to multiple account on openshift:
http://stackoverflow.com/a/33318301/474330

mongodb reference:
https://docs.mongodb.org/getting-started/shell/

mongodb GUI tool:
https://github.com/jeromelebel/MongoHub-Mac

+ Ruby 2.0 cartridge, no auto-scaling
+ MongoDB 2.4 cartridge
+ RockMongo 1.1 cartridge

MongoDB 2.4 database added.  Please make note of these credentials:

   Root User:     admin
   Root Password: 6dWPx698Z-9k
   Database Name: ruby

Connection URL: mongodb://$OPENSHIFT_MONGODB_DB_HOST:$OPENSHIFT_MONGODB_DB_PORT/

Please make note of these MongoDB credentials:
  RockMongo User: admin
  RockMongo Password: 6dWPx698Z-9k
URL: https://ruby-vvydmk.rhcloud.com/rockmongo/

setting up the development on local:
1. install mongodb - choose download manually from MongoDB download site and choose version 2.4 final
https://docs.mongodb.org/getting-started/shell/tutorial/install-mongodb-on-os-x/
2. run mongodb using this command:
mongod --dbpath /Applications/Mongo/data/db
3a. import data into the collection
mongoimport --db vvydmk --collection ScoreDaily --drop --file ./tmp/parsedb/ScoreDaily.json --jsonArray
mongoimport --db vvydmk --collection _Installation --drop --file ./tmp/parsedb/_Installation.json --jsonArray
mongoimport --db vvydmk --collection _User --drop --file ./tmp/parsedb/_User.json --jsonArray
mongoimport --db vvydmk --collection TestObject --drop --file ./tmp/parsedb/TestObject.json --jsonArray

3b. import data into openshift: note that the db need to be $OPENSHIFT_APP_NAME
mongoimport --db $OPENSHIFT_APP_NAME --collection ScoreDaily --host $OPENSHIFT_MONGODB_DB_HOST --port $OPENSHIFT_MONGODB_DB_PORT --username $OPENSHIFT_MONGODB_DB_USERNAME --password $OPENSHIFT_MONGODB_DB_PASSWORD --drop --file $OPENSHIFT_REPO_DIR/tmp/parsedb/ScoreDaily.json --jsonArray
mongoimport --db $OPENSHIFT_APP_NAME --collection _Installation --host $OPENSHIFT_MONGODB_DB_HOST --port $OPENSHIFT_MONGODB_DB_PORT --username $OPENSHIFT_MONGODB_DB_USERNAME --password $OPENSHIFT_MONGODB_DB_PASSWORD --drop --file $OPENSHIFT_REPO_DIR/tmp/parsedb/_Installation.json --jsonArray
mongoimport --db $OPENSHIFT_APP_NAME --collection _User --host $OPENSHIFT_MONGODB_DB_HOST --port $OPENSHIFT_MONGODB_DB_PORT --username $OPENSHIFT_MONGODB_DB_USERNAME --password $OPENSHIFT_MONGODB_DB_PASSWORD --drop --file $OPENSHIFT_REPO_DIR/tmp/parsedb/_User.json --jsonArray
mongoimport --db $OPENSHIFT_APP_NAME --collection TestObject --host $OPENSHIFT_MONGODB_DB_HOST --port $OPENSHIFT_MONGODB_DB_PORT --username $OPENSHIFT_MONGODB_DB_USERNAME --password $OPENSHIFT_MONGODB_DB_PASSWORD --drop --file $OPENSHIFT_REPO_DIR/tmp/parsedb/TestObject.json --jsonArray

3c. setup mongodb with mongoid
rails g mongoid:config

3d. generate mongoid model
rails generate model #printout helps
rails generate model ScoreDaily

4. setup rails
http://guides.rubyonrails.org/getting_started.html
cd ${GIT_ROOT}/../
rails new railsapp
# ./railsapp/bin/bundle install --path ./railsapp/vendor/bundle
# ./railsapp/bin/bundle install --path vendor/bundle
cd railsapp
./bin/bundle install --path vendor/bundle
5. run the rail server locally
./bin/rails server

bundle install nokogiri failed inside openshift,
ssh to the gear, and run
gem install nokogiri -- --use-system-libraries
works., but the bundle install afterwards will still try to reinstall nokogiri and failed again, we'd need to make the bundle install nokogiri working, by doing this locally:
bundle config --local build.nokogiri --use-system-libraries
then commit and push the .bundle/config file
if we need to run bundle install locally (e.g. to generate the Gemfile.lock file), we need to delete off the .bundle/config because that will cause the build to fail locally

to delete off the global bundle config:
bundle

or to remove the local bundle config, run:
bundle config --local build.nokogiri ""

-a ruby: here is the <application name>
rhc env set RAILS_ENV=development -a ruby
rhc env-unset RAILS_ENV -a ruby

create a route:
./bin/rails generate controller welcome index

NOTE for commit-id 28239dd:
It is actually working, just that the collection mongoid is searching is score_dailies

<%= "#{ENV['$OPENSHIFT_MONGODB_DB_HOST']}:#{ENV['OPENSHIFT_MONGODB_DB_PORT']}" %>
puts "#{ENV['$OPENSHIFT_MONGODB_DB_HOST']}:#{ENV['OPENSHIFT_MONGODB_DB_PORT']}"
<%= "#{ENV['$OPENSHIFT_MONGODB_DB_HOST']}:#{ENV['$OPENSHIFT_MONGODB_DB_PORT']}" %>
http://help.cloud66.com/database-management/mongodb-replica-sets

=======================================================================================
For daimoku challenge server: Started 27 February 2016

Hakims-MacBook-Pro:openshift-vvydmk hakimhauston$ ./bin/rails generate controller user fblogin
      create  app/controllers/user_controller.rb
       route  get 'user/fblogin'
      invoke  erb
      create    app/views/user
      create    app/views/user/fblogin.html.erb
      invoke  test_unit
      create    test/controllers/user_controller_test.rb
      invoke  helper
      create    app/helpers/user_helper.rb
      invoke    test_unit
      invoke  assets
      invoke    coffee
      create      app/assets/javascripts/user.coffee
      invoke    scss
      create      app/assets/stylesheets/user.scss
Hakims-MacBook-Pro:openshift-vvydmk hakimhauston$ ./bin/rails generate model User
      invoke  mongoid
      create    app/models/user.rb
      invoke    test_unit
      create      test/models/user_test.rb
      create      test/fixtures/users.yml
Hakims-MacBook-Pro:openshift-vvydmk hakimhauston$ 

error:
http://localhost:3000/user/fblogin/10154127801799546/hakim
result:
{"_id":{"$oid":"56d2872f00af597fa584e366"},"authData":{"facebook":{"access_token":"CAAWtEfU555EBAG2QksAEQnLMXJP9lOpHMHPV6ZChKYmKQrjYu8w3K4VFBvUBQ86Uxa8EU8LyFFLFrASBvcHcjh7dZBIAtVyIGjV9ECBc1soKEFdKx7QBcU3j1S1P7tLArec43FWFrmmjmCiu1Qlq6g2y96ZBNEyJWo1OsPKQ7RGrHdia5wPRBEAFpAkCk3TGdtEB3L6ydDL8h0Qnb4PXODS4s0B44Bm0XZCQWsg4HgZDZD","expiration_date":"2015-12-19T14:17:25.000Z","id":"10154127801799546"}},"bcryptPassword":"$2a$10$..uyc0vx3l3MRLX.JIiSr.SQ2/fb7MepKW8xhzvYHuadXzVw3DbDG","competitorFbid":null,"createdAt":null,"created_at":null,"facebookname":null,"fbid":null,"objectId":"H5cEMtUzMo","runCount":790,"sessionToken":"KGtW7lAhH1EFm4onMk3bbZZ2b","updatedAt":null,"updated_at":null,"username":"MN79Ddn7Joij2YDBB64LLGZBs"}
waiting response:
http://stackoverflow.com/questions/35679841/mongoid-criteria-result-doesnt-fill-all-field

testing POST with curl:
curl -d "paramkey=paramvalue" http://localhost:3000/scoredaily/calculatescoreformonth
HakimRocketsMBP:openshift-vvydmk HakimHauston$ curl -d "hello=world" http://localhost:3000/scoredaily/calculatescoreformonth
{"hello":"world","controller":"scoredaily","action":"calculatescoreformonth"}HakimRocketsMBP:openshift-vvydmk HakimHauston$ 

curl -d "userid=566020605&year=2016&month=03" http://localhost:3000/scoredaily/calculatemonthly

create and/or update scoredaily:
curl -d "userid=10153368070540606&scoredate=2016-03-07&score=20" http://localhost:3000/scoredaily/submitscoredaily

myscore:
curl -d "userid=10153368070540606&scoredate=2016-02-29&score=310" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10153368070540606&scoredate=2016-03-01&score=100" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10153368070540606&scoredate=2016-03-02&score=90" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10153368070540606&scoredate=2016-03-03&score=80" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10153368070540606&scoredate=2016-03-04&score=70" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10153368070540606&scoredate=2016-03-05&score=60" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10153368070540606&scoredate=2016-03-06&score=50" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10153368070540606&scoredate=2016-03-07&score=40" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10153368070540606&scoredate=2016-03-08&score=30" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10153368070540606&scoredate=2016-03-09&score=20" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10153368070540606&scoredate=2016-03-10&score=10" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily

vvyscore:
curl -d "userid=10154127801799546&scoredate=2016-02-29&score=290" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10154127801799546&scoredate=2016-03-01&score=10" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10154127801799546&scoredate=2016-03-02&score=20" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10154127801799546&scoredate=2016-03-03&score=30" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10154127801799546&scoredate=2016-03-04&score=40" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10154127801799546&scoredate=2016-03-05&score=50" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10154127801799546&scoredate=2016-03-06&score=60" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10154127801799546&scoredate=2016-03-07&score=70" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10154127801799546&scoredate=2016-03-08&score=80" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10154127801799546&scoredate=2016-03-09&score=90" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily
curl -d "userid=10154127801799546&scoredate=2016-03-10&score=100" http://ruby-vvydmk.rhcloud.com/scoredaily/submitscoredaily

curl -d "userid=10153368070540606&datemonth=2016-03-08" http://ruby-vvydmk.rhcloud.com/scoredaily/calculatescoreformonth

// pushwoosh
// \"send_date\": \"now\", // YYYY-MM-DD HH:mm  OR 'now'
curl -H "Content-Type: application/json" -d "{\"request\": {\"application\": \"APPLICATION_CODE\", \"auth\": \"API_ACCESS_TOKEN\", \"notifications\": [{ \"send_date\": \"now\", \"ignore_user_timezone\": true, \"content\": \"Hello world!\" }] } }" https://cp.pushwoosh.com/json/1.3/createMessage

curl -H "Content-Type: application/json" -X POST -d '{"request": {"application": "159BE-CF9A3", "auth": "kFLQ3ABsEXcAkIrBU09s29oZagBZoSX4bWSuxuEI8PoXMHmGNW2JGpkLOvAiPepbMwHqEo6YkWinmPxvWdsh", "notifications": [{ "send_date": "now", "ignore_user_timezone": true, "content": "Hello world!" }] } }' https://cp.pushwoosh.com/json/1.3/createMessage